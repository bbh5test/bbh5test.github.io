import{C as u}from"./chatItem.f50a10c2.js";import{_ as m,d as v,g as d,i as c,j as a,w as p,r as i,o as r,F as L,x as $,f as M}from"./index.c378eab7.js";import"./avatar.57947a22.js";import"./roleTag.8f71a48e.js";import"./dialogBase.8ad30566.js";const B={name:"Pined",components:{ChatItem:u},computed:{title(){return`\u7F6E\u9876\u6D88\u606F(${this.$store.state.group.pinedMsgTotal})`}},data(){return{listLoading:!1,listFinished:!1}},methods:{async onLastPage(){let e=-1;this.$store.state.group.pinedMsgList.length>0&&(e=this.$store.state.group.pinedMsgList[0].id);let t=await v.group.getPinedMsgs(this.$store.state.group.groupId,10,e);if(t.status==1){if(t.data.pinMsg.length>0)for(let s=t.data.pinMsg.length-1;s>=0;s--)console.log(t.data.pinMsg[s].id),this.$store.commit("addPinedMsgUnshift",t.data.pinMsg[s]);t.data.pinMsg.length<10&&(this.listFinished=!0)}this.$refs.rightBody.scrollTop=1,this.listLoading=!1},scrollToBottom(){this.$nextTick(()=>{this.$refs.rightBody.scrollTop=this.$refs.rightBody.scrollHeight})}},mounted(){this.scrollToBottom()}},x={class:"container"},y={class:"content",ref:"rightBody"};function k(e,t,s,C,n,l){const g=i("van-nav-bar"),h=i("ChatItem"),_=i("van-cell"),f=i("van-list");return r(),d("section",x,[c("div",null,[a(g,{"left-arrow":"",fixed:"",placeholder:"","safe-area-inset-top":"","z-index":"2",title:l.title,onClickLeft:t[0]||(t[0]=o=>e.$router.go(-1))},null,8,["title"])]),c("div",y,[a(f,{class:"chat-list","finished-text":"\u6CA1\u6709\u66F4\u591A\u4E86",direction:"up",loading:n.listLoading,"onUpdate:loading":t[1]||(t[1]=o=>n.listLoading=o),finished:n.listFinished,onLoad:l.onLastPage,"immediate-check":!1},{default:p(()=>[(r(!0),d(L,null,$(e.$store.state.group.pinedMsgList,o=>(r(),M(_,{key:o.id},{default:p(()=>[a(h,{source:o},null,8,["source"])]),_:2},1024))),128))]),_:1},8,["loading","finished","onLoad"])],512)])}const w=m(B,[["render",k],["__scopeId","data-v-9115ebce"]]);export{w as default};
