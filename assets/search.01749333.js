import{D as $}from"./dialogBase.394c609a.js";import{A as k}from"./avatar.f2c87f6f.js";import{_ as T,T as w,k as u,d as c,b as s,m as d,w as h,F as _,r as i,o as r,x as B,t,a as p,e as m}from"./index.bf36d87d.js";const L={name:"Search",components:{DialogBase:$,Avatar:k},watch:{searchText(e){e||(this.groupList=[])}},data(){return{searchLoading:!1,createVisable:!1,currentGroup:{name:"",address:"",chain:"",type:""},searchText:"",groupList:[]}},methods:{formatTimestamp(e){let o=this.$dayjs.unix(e);return o.isToday()?o.format("HH:mm"):o.isYesterday()?this.$t("yesterday")+" "+o.format("HH:mm"):o.format("YYYY-MM-DD HH:mm")},onCancel(){this.$router.push({name:"Chats"})},async onSearch(){if(!this.searchText){w(this.$t("searchKeywordCannotBeEmpty"));return}this.groupList=[],this.searchLoading=!0;let e=await u.group.search(this.searchText);this.searchLoading=!1,this.groupList=e.data?e.data:[]},clickGroup(e){e.isCreated?this.$router.push("/group/"+e.address+"-"+e.chain+"/chat"):(this.currentGroup.name=this.$f.getGroupShowName(e),this.currentGroup.address=e.address,this.currentGroup.chain=e.chain,this.currentGroup.type=e.type,this.createVisable=!0)},async createGroup(){let e=await u.group.create(this.currentGroup.address,this.currentGroup.chain,this.currentGroup.type);console.log(e),e.status==1&&this.$router.push("/group/"+e.data.groupId+"/chat")}},mounted(){this.$refs.searchBar.focus()}},S={class:"myChats-container"},V={class:"search-content"},N={action:"/"},D={class:"chats-container"},H={class:"chat-item"},A={class:"content"},Y={class:"left"},x={class:"title"},j={key:0,class:"tag"},I={key:1,class:"tag tag-no-join"},J={key:2,class:"tag tag-no-create"},z={class:"desc"},E={class:"info"},F={key:0,class:"time"},K={class:"dialog-body"},M={class:"tip"},O={class:"cell-list"},U={class:"cell"},P={class:"lable"},q={class:"value"},Q={class:"cell"},R={class:"lable"},W={class:"value"},X={class:"cell"},Z={class:"lable"},ee={class:"value"};function se(e,o,ae,te,n,l){const v=i("van-nav-bar"),f=i("van-search"),g=i("Avatar"),y=i("van-icon"),C=i("van-cell"),G=i("van-list"),b=i("DialogBase");return r(),c(_,null,[s("section",S,[s("div",null,[d(v,{fixed:"","safe-area-inset-top":"","z-index":"2",title:"Chats"})]),s("div",V,[s("form",N,[d(f,{modelValue:n.searchText,"onUpdate:modelValue":o[0]||(o[0]=a=>n.searchText=a),shape:"round","show-action":"",placeholder:e.$t("enterSearchKeyword"),ref:"searchBar",onCancel:l.onCancel,onSearch:l.onSearch,"action-text":e.$t("cancel")},null,8,["modelValue","placeholder","onCancel","onSearch","action-text"])]),s("div",D,[d(G,{loading:n.searchLoading,"loading-text":e.$t("loading")},{default:h(()=>[(r(!0),c(_,null,B(n.groupList,a=>(r(),p(C,{onClick:oe=>l.clickGroup(a),class:"chat-item-cell"},{default:h(()=>[s("div",H,[d(g,{class:"avatar",image:a.image?a.image:e.$f.formatIcon({chain:a.chain,address:a.address}),address:a.address},null,8,["image","address"]),s("div",A,[s("div",null,[s("div",Y,[s("div",x,t(e.$f.getGroupShowName(a)),1),a.isJoined?(r(),c("span",j,t(e.$t("joined")),1)):a.isCreated&&!a.isJoined?(r(),c("span",I,t(e.$t("unJoined")),1)):(r(),c("span",J,t(e.$t("unCreated")),1)),a.hasProvider?(r(),p(y,{key:3,class:"cert",size:"0.4rem",name:"/assets/images/certification.png"})):m("",!0)]),s("div",z,t(`${a.memberCount} ${e.$t("members")}`),1)]),s("div",E,[a.lastChatTime?(r(),c("div",F,t(l.formatTimestamp(a.lastChatTime)),1)):m("",!0)])])])]),_:2},1032,["onClick"]))),256))]),_:1},8,["loading","loading-text"])])])]),d(b,{class:"create-dialog",visible:n.createVisable,"onUpdate:visible":o[1]||(o[1]=a=>n.createVisable=a),title:e.$t("tips"),showCancelButton:"",onOnConfirm:l.createGroup},{default:h(()=>[s("div",K,[s("div",M,t(e.$t("createGroupTips")),1),s("div",O,[s("div",U,[s("div",P,t(e.$t("groupName")+":"),1),s("div",q,t(n.currentGroup.name),1)]),s("div",Q,[s("div",R,t(e.$t("tokenAddress")+":"),1),s("div",W,t(e.$f.getGroupShowName({address:n.currentGroup.address})),1)]),s("div",X,[s("div",Z,t(e.$t("chainName")+":"),1),s("div",ee,t(n.currentGroup.chain),1)])])])]),_:1},8,["visible","title","onOnConfirm"])],64)}const ce=T(L,[["render",se],["__scopeId","data-v-ab7f62a9"]]);export{ce as default};
