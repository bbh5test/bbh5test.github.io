import{_ as V,r as n,o as a,f,w as d,i as t,j as i,k as p,p as T,l as B,A as z,d as y,c as A,g as c,y as D,h as u,t as M,q as C,v as w,F as L,u as F}from"./index.2b2030c9.js";import{M as J}from"./memberItem.c7238d6e.js";const E={name:"BecomeManager",props:{visible:Boolean},components:{},data(){return{}},computed:{dialogVisible:{get(){return this.visible},set(s){this.$emit("update:visible",s)}}},watch:{},methods:{becomeManager(){this.$store.commit("setTradeVisable",!0),this.$store.commit("setPaymentType",0),this.dialogVisible=!1}},created(){},mounted(){}},m=s=>(T("data-v-db27ec0e"),s=s(),B(),s),O=m(()=>t("h3",{class:"title"}," \u6210\u4E3A\u7BA1\u7406\u5458 ",-1)),q={class:"content"},R=m(()=>t("div",{class:"info"},[p("\u7BA1\u7406\u5458\u5E2D\u4F4D\u8FD8\u6709"),t("span",null,"5"),p("\u4E2A\uFF0C\u4F60\u53EF\u4EE5\u6210\u4E3A\u6B64Token\u7FA4\u7684\u7BA1\u7406\u5458")],-1)),W={class:"privilege"},P=m(()=>t("div",{class:"privilege-info"},"\u6210\u4E3A\u7BA1\u7406\u5458\u540E\uFF0C\u60A8\u5C06\u62E5\u6709\u4EE5\u4E0B\u7279\u6743\uFF1A",-1)),H={class:"privilege-list"},K=m(()=>t("div",{class:"item"},[t("div",{class:"img"},[t("i",{class:"iconfont icon-kick"})]),t("div",{class:"text"}," \u7981\u8A00\u6216\u8E22\u51FA ")],-1)),Q=m(()=>t("div",{class:"item"},[t("div",{class:"img"},[t("i",{class:"iconfont icon-zhiding"})]),t("div",{class:"text"}," \u7F6E\u9876\u6D88\u606F ")],-1)),X={class:"item"},Y={class:"img"},Z=m(()=>t("div",{class:"text"}," \u7BA1\u7406\u7FA4\u7EC4 ",-1)),$={class:"item"},ee={class:"img"},te=m(()=>t("div",{class:"text"}," \u66F4\u591A\u7279\u6743 ",-1)),se={class:"action-bar"},oe=p("\u786E\u5B9A ");function ie(s,o,x,N,l,e){const h=n("van-icon"),v=n("van-button"),b=n("van-popup");return a(),f(b,{show:e.dialogVisible,"onUpdate:show":o[0]||(o[0]=_=>e.dialogVisible=_),closeable:!0,round:"",position:"center",teleport:"#app",class:"become-manager"},{default:d(()=>[O,t("div",q,[R,t("div",W,[P,t("div",H,[K,Q,t("div",X,[t("div",Y,[i(h,{class:"icon-svg",size:"1.3em",name:"/assets/images/set.png"})]),Z]),t("div",$,[t("div",ee,[i(h,{class:"icon-svg",size:"1.3em",name:"/assets/images/tequan.png"})]),te])])])]),t("div",se,[i(v,{type:"primary",class:"btn",onClick:e.becomeManager},{default:d(()=>[oe]),_:1},8,["onClick"])])]),_:1},8,["show"])}const re=V(E,[["render",ie],["__scopeId","data-v-db27ec0e"]]),ae={name:"GroupDetail",inject:["reload"],components:{MemberItem:J,Avatar:z,BecomeManager:re},watch:{},computed:{groupInfo(){var s;return(s=this.$store.state)==null?void 0:s.group}},mounted(){console.log(this.pageNumber),this.init()},data(){return{becomeManagerVisible:!1,groupMemberList:[],loading:!1,finished:!1,error:!1,pageSize:50,pageNumber:1}},methods:{async init(){let s=this.$toast.loading({message:"Loading...",forbidClick:!0,duration:0});this.loading=!1,this.finished=!1,this.error=!1,this.pageNumber=1;try{await this.getMemberList()}catch(o){console.log(o)}finally{s.clear()}},async getMemberList(){this.loading=!0;try{let s=this.groupInfo.groupId;if(!s)return;let o=await y.groupMember.getMemberList(s,this.pageSize,this.pageNumber,[0,1,2]);console.log(o),this.pageNumber==1&&(this.groupMemberList=[]),o.status==1?(this.groupMemberList=this.groupMemberList.concat(o.data),o.data.length<this.pageSize||this.groupMemberList.length>=this.groupInfo.totalMembers?this.finished=!0:(this.pageNumber++,console.log(this.pageNumber))):this.error=!0}catch{this.error=!0}finally{setTimeout(()=>{this.loading=!1},1e3)}},editGroup(){this.$router.push({name:"GroupSet",params:{groupId:this.groupInfo.groupId}})},shareLink(){let s=window.document.location.host+"/group/"+this.groupInfo.groupId+"/chat";A(s)},openBecomeManager(){this.becomeManagerVisible=!0},jumpToViolation(){(this.groupInfo.status==2||this.groupInfo.status==3)&&this.$router.push({name:"DealWithViolation",params:{groupId:this.groupInfo.groupId}})},jumpToEditOfficial(){this.$router.push({name:"GroupOfficialSet",params:{groupId:this.groupInfo.groupId}})},jumpToBanned(){this.$router.push({name:"Banned",params:{groupId:this.groupInfo.groupId}})},jumpAddViolation(){this.$router.push({name:"AddViolation",params:{groupId:this.groupInfo.groupId}})},leaveGroup(){this.$dialog.confirm({title:"\u63D0\u793A",message:"\u662F\u5426\u9000\u51FA\u7FA4\u804A",confirmButtonText:"\u786E\u8BA4",confirmButtonColor:"#3F80F7",cancelButtonText:"\u53D6\u6D88"}).then(async()=>{try{(await y.group.leave(this.groupInfo.groupId)).status==1&&this.$router.push("/chats")}catch(s){console.log(s)}}).catch(()=>{})}}},I=s=>(T("data-v-cc084a0e"),s=s(),B(),s),ne={class:"group-detail"},le={class:"group-content"},ce={class:"section-top"},ue={class:"nickname"},de={key:0,class:"svg-box"},ge={key:1,class:"svg-box"},me={class:"members"},pe={class:"section-center"},he={key:0,class:"section-btn"},_e=p("\u5206\u4EAB\u7FA4\u94FE\u63A5"),fe=p("\u7BA1\u7406\u5458"),ve={key:0,class:"weigui-handle"},be={key:1,class:"official-renzheng"},Ie={class:"left-title"},ke=I(()=>t("span",{class:"custom-title"},"\u5F00\u901A\u9879\u76EE\u5B98\u65B9\u8BA4\u8BC1",-1)),ye={class:"svg-box"},Me={class:"member-box"},Ce=p(" \u67E5\u770B\u7981\u8A00\u5217\u8868 "),we={class:"member-list"},Le={key:2,class:"bottom-operate"},Ve={key:0,class:"type-1"},Te=I(()=>t("div",null,"\u5904\u7F5A\u8FDD\u89C4",-1)),Be=[Te],xe=I(()=>t("div",null,"\u9000\u51FA\u7FA4\u804A",-1)),Ne=[xe],je={key:1,class:"type-2"};function Se(s,o,x,N,l,e){const h=n("van-icon"),v=n("van-nav-bar"),b=n("Avatar"),_=n("van-image"),g=n("van-cell"),k=n("van-button"),j=n("MemberItem"),S=n("van-empty"),U=n("van-list"),G=n("become-manager");return a(),c(L,null,[t("div",ne,[t("div",null,[i(v,{onClickLeft:o[0]||(o[0]=r=>s.$router.push({name:"Chat",params:{groupId:s.$route.params.groupId}})),"left-arrow":"",fixed:"",placeholder:"","safe-area-inset-top":"","z-index":"2",title:"\u7FA4\u8BE6\u60C5"},D({_:2},[e.groupInfo.currentUser.role==1||e.groupInfo.currentUser.role==2?{name:"right",fn:d(()=>[e.groupInfo.currentUser.role==1||e.groupInfo.currentUser.role==2?(a(),f(h,{key:0,class:"icon",size:"1.6em",name:"/assets/images/edit.png",onClick:e.editGroup},null,8,["onClick"])):u("",!0)])}:void 0]),1024)]),t("div",null,[t("div",le,[t("div",ce,[i(b,{class:"avatar",image:e.groupInfo.image,address:e.groupInfo.address},null,8,["image","address"]),t("div",ue,[t("span",null,M(e.groupInfo.nickname),1),e.groupInfo.providers.length>0?(a(),c("div",de,[i(_,{class:"img",src:"/assets/images/certification.png"})])):u("",!0),e.groupInfo.type=="nft"?(a(),c("div",ge,[i(_,{class:"img",src:"/assets/images/NFT.png"})])):u("",!0)]),t("div",me,M(e.groupInfo.totalMembers)+" \u6210\u5458 ",1)]),t("div",pe,[i(g,{title:"Token\u540D\u79F0\uFF1A",border:!1,value:e.groupInfo.name},null,8,["value"]),i(g,{title:"\u94FE\u540D\u79F0\uFF1A",border:!1,value:e.groupInfo.chain},null,8,["value"]),i(g,{title:"\u5B98\u65B9\u7F51\u7AD9\uFF1A",border:!1,value:e.groupInfo.officialWebsiteUrl},null,8,["value"]),i(g,{title:"\u7B80\u4ECB\uFF1A",border:!1,value:e.groupInfo.description||""},null,8,["value"])]),e.groupInfo.isJoined?(a(),c("div",he,[i(k,{class:"share-btn btn",round:"",block:"","native-type":"submit",type:"default",onClick:e.shareLink},{default:d(()=>[_e]),_:1},8,["onClick"]),C(i(k,{class:"admin-btn btn",round:"",block:"","native-type":"submit",onClick:e.openBecomeManager,type:"primary"},{default:d(()=>[fe]),_:1},8,["onClick"]),[[w,e.groupInfo.managers.length<5&&e.groupInfo.currentUser.role==0]])])):u("",!0)]),e.groupInfo.isJoined?(a(),c("div",ve,[i(g,{title:"\u7FA4\u8FDD\u89C4\u5904\u7406","is-link":"","value-class":e.groupInfo.status==2||e.groupInfo.status==3?"active":"",value:e.groupInfo.status==2||e.groupInfo.status==3?"\u6709\u5904\u7F5A\uFF0C\u53BB\u5904\u7406":"\u65E0\u5904\u7F5A",onClick:e.jumpToViolation},null,8,["value-class","value","onClick"])])):u("",!0),e.groupInfo.isJoined?(a(),c("div",be,[e.groupInfo.providers.length==0||e.groupInfo.currentUser.role==2?(a(),f(g,{key:0,"is-link":"",onClick:e.jumpToEditOfficial},{title:d(()=>[t("div",Ie,[ke,t("div",ye,[i(_,{class:"img",src:"/assets/images/certification.png"})])])]),_:1},8,["onClick"])):u("",!0)])):u("",!0),t("div",Me,[i(g,{title:"\u7FA4\u6210\u5458("+e.groupInfo.totalMembers+")",border:!1},{"right-icon":d(()=>[t("span",{onClick:o[1]||(o[1]=(...r)=>e.jumpToBanned&&e.jumpToBanned(...r))},[Ce,i(h,{name:"arrow",class:"arrow-icon"})])]),_:1},8,["title"]),t("div",we,[i(U,{loading:l.loading,"onUpdate:loading":o[2]||(o[2]=r=>l.loading=r),offset:"100","loading-text":s.$t("loading"),finished:l.finished,"finished-text":s.$t("noMore"),error:l.error,"onUpdate:error":o[3]||(o[3]=r=>l.error=r),"error-text":s.$t("errorText"),onLoad:e.getMemberList,"immediate-check":!1},{default:d(()=>[(a(!0),c(L,null,F(l.groupMemberList,(r,Ue)=>(a(),f(j,{groupMemberItem:r,role:s.$store.state.user.role,userRole:s.$store.state.user.role},null,8,["groupMemberItem","role","userRole"]))),256)),C(i(S,{class:"empty",image:s.emptyNoDataLight,description:s.$t("emptyData")},null,8,["image","description"]),[[w,l.groupMemberList&&l.groupMemberList.length===0&&!l.loading]])]),_:1},8,["loading","loading-text","finished","finished-text","error","error-text","onLoad"])])]),e.groupInfo.isJoined?(a(),c("div",Le,[s.$store.state.user.role==2||s.$store.state.user.role==3?(a(),c("div",Ve,[t("div",{class:"weigui",onClick:o[4]||(o[4]=(...r)=>e.jumpAddViolation&&e.jumpAddViolation(...r))},Be),t("div",{class:"out",onClick:o[5]||(o[5]=(...r)=>e.leaveGroup&&e.leaveGroup(...r))},Ne)])):(a(),c("div",je,[t("div",{class:"out",onClick:o[6]||(o[6]=(...r)=>e.leaveGroup&&e.leaveGroup(...r))}," \u9000\u51FA\u7FA4\u804A ")]))])):u("",!0)])]),i(G,{visible:l.becomeManagerVisible,"onUpdate:visible":o[7]||(o[7]=r=>l.becomeManagerVisible=r)},null,8,["visible"])],64)}const Ae=V(ae,[["render",Se],["__scopeId","data-v-cc084a0e"]]);export{Ae as default};
