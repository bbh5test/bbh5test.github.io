import{D as S}from"./dialogBase.b4c3c5f9.js";import{A as w}from"./avatar.969190d1.js";import{_ as V,T as B,k as v,d as p,b as s,m as d,w as i,F as f,r,o as c,x as L,t as n,a as h,f as m,e as g,p as $,g as D}from"./index.2fbacc60.js";const N={name:"Search",components:{DialogBase:S,Avatar:w},watch:{searchText(e){e||(this.groupList=[])}},data(){return{searchLoading:!1,createVisable:!1,currentGroup:{name:"",address:"",chain:"",type:""},searchText:"",groupList:[]}},methods:{formatTimestamp(e){let t=this.$dayjs.unix(e);return t.isToday()?t.format("HH:mm"):t.isYesterday()?this.$t("yesterday")+" "+t.format("HH:mm"):t.format("YYYY-MM-DD HH:mm")},onCancel(){this.$router.push({name:"Chats"})},async onSearch(){if(!this.searchText){B("\u641C\u7D22\u5185\u5BB9\u4E0D\u80FD\u4E3A\u7A7A");return}this.groupList=[],this.searchLoading=!0;let e=await v.group.search(this.searchText);this.searchLoading=!1,console.dir(e),this.groupList=e.data?e.data:[]},clickGroup(e){e.isCreated?this.$router.push("/group/"+e.address+"-"+e.chain+"/chat"):(this.currentGroup.name=this.$f.getGroupShowName(e),this.currentGroup.address=e.address,this.currentGroup.chain=e.chain,this.currentGroup.type=e.type,this.createVisable=!0)},async createGroup(){let e=await v.group.create(this.currentGroup.address,this.currentGroup.chain,this.currentGroup.type);console.log(e),e.status==1&&this.$router.push("/group/"+e.data.groupId+"/chat")}},mounted(){this.$refs.searchBar.focus()}},u=e=>($("data-v-4929e527"),e=e(),D(),e),H={class:"myChats-container"},I={action:"/"},Y={class:"chats-container"},A={class:"chat-item"},j={class:"content"},J={class:"left"},z={class:"title"},F={class:"desc"},M={class:"info"},O={key:0,class:"time"},U={class:"dialog-body"},E=u(()=>s("div",{class:"tip"},"\u8FD9\u4E2AToken\u7684\u7FA4\u804A\u8FD8\u672A\u88AB\u521B\u5EFA,\u4F60\u786E\u5B9A\u521B\u5EFA\u5E76\u52A0\u5165\u5B83\u5417?",-1)),P={class:"cell-list"},q={class:"cell"},K=u(()=>s("div",{class:"lable"},"\u7FA4\u540D\u79F0:",-1)),Q={class:"value"},R={class:"cell"},W=u(()=>s("div",{class:"lable"},"Token\u5730\u5740:",-1)),X={class:"value"},Z={class:"cell"},ee=u(()=>s("div",{class:"lable"},"\u94FE\u540D\u79F0:",-1)),se={class:"value"};function ae(e,t,te,oe,o,l){const y=r("van-nav-bar"),C=r("van-search"),G=r("Avatar"),_=r("sapn"),b=r("van-icon"),T=r("van-cell"),k=r("van-list"),x=r("DialogBase");return c(),p(f,null,[s("section",H,[s("div",null,[d(y,{fixed:"",placeholder:"","safe-area-inset-top":"","z-index":"2",title:"Chats"})]),s("div",null,[s("form",I,[d(C,{modelValue:o.searchText,"onUpdate:modelValue":t[0]||(t[0]=a=>o.searchText=a),shape:"round","show-action":"",placeholder:"\u8BF7\u8F93\u5165\u641C\u7D22\u5173\u952E\u8BCD",ref:"searchBar",onCancel:l.onCancel,onSearch:l.onSearch,"action-text":e.$t("cancel")},null,8,["modelValue","onCancel","onSearch","action-text"])]),s("div",Y,[d(k,{"error-text":" \u8BF7\u6C42\u5931\u8D25\uFF0C\u70B9\u51FB\u91CD\u65B0\u52A0\u8F7D",loading:o.searchLoading,"loading-text":e.$t("loading")},{default:i(()=>[(c(!0),p(f,null,L(o.groupList,a=>(c(),h(T,{onClick:ne=>l.clickGroup(a),class:"chat-item-cell"},{default:i(()=>[s("div",A,[d(G,{class:"avatar",image:a.image?a.image:e.$f.formatIcon({chain:a.chain,address:a.address}),address:a.address},null,8,["image","address"]),s("div",j,[s("div",null,[s("div",J,[s("div",z,n(e.$f.getGroupShowName(a)),1),a.isJoined?(c(),h(_,{key:0,class:"tag"},{default:i(()=>[m(n(e.$t("joined")),1)]),_:1})):a.isCreated&&!a.isJoined?(c(),h(_,{key:1,class:"tag tag-no-join"},{default:i(()=>[m(n(e.$t("unJoined")),1)]),_:1})):(c(),h(_,{key:2,class:"tag tag-no-create"},{default:i(()=>[m(n(e.$t("unCreated")),1)]),_:1})),a.hasProvider?(c(),h(b,{key:3,class:"cert",size:"0.4rem",name:"/assets/images/certification.png"})):g("",!0)]),s("div",F,n(`${a.memberCount} ${e.$t("members")}`),1)]),s("div",M,[a.lastChatTime?(c(),p("div",O,n(l.formatTimestamp(a.lastChatTime)),1)):g("",!0)])])])]),_:2},1032,["onClick"]))),256))]),_:1},8,["loading","loading-text"])])])]),d(x,{class:"create-dialog",visible:o.createVisable,"onUpdate:visible":t[1]||(t[1]=a=>o.createVisable=a),title:"\u63D0\u793A",showCancelButton:"",onOnConfirm:l.createGroup},{default:i(()=>[s("div",U,[E,s("div",P,[s("div",q,[K,s("div",Q,n(o.currentGroup.name),1)]),s("div",R,[W,s("div",X,n(e.$f.getGroupShowName({address:o.currentGroup.address})),1)]),s("div",Z,[ee,s("div",se,n(o.currentGroup.chain),1)])])])]),_:1},8,["visible","onOnConfirm"])],64)}const le=V(N,[["render",ae],["__scopeId","data-v-4929e527"]]);export{le as default};
