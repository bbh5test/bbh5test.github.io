import{D as k}from"./dialogBase.1146a7ec.js";import{A as w}from"./avatar.0e846d0c.js";import{_ as B,T as V,k as m,d as _,b as s,m as d,w as i,F as v,r,o as c,x as L,t,a as h,f as p,e as f}from"./index.334a89c2.js";const S={name:"Search",components:{DialogBase:k,Avatar:w},watch:{searchText(e){e||(this.groupList=[])}},data(){return{searchLoading:!1,createVisable:!1,currentGroup:{name:"",address:"",chain:"",type:""},searchText:"",groupList:[]}},methods:{formatTimestamp(e){let o=this.$dayjs.unix(e);return o.isToday()?o.format("HH:mm"):o.isYesterday()?this.$t("yesterday")+" "+o.format("HH:mm"):o.format("YYYY-MM-DD HH:mm")},onCancel(){this.$router.push({name:"Chats"})},async onSearch(){if(!this.searchText){V(this.$t("searchKeywordCannotBeEmpty"));return}this.groupList=[],this.searchLoading=!0;let e=await m.group.search(this.searchText);this.searchLoading=!1,this.groupList=e.data?e.data:[]},clickGroup(e){e.isCreated?this.$router.push("/group/"+e.address+"-"+e.chain+"/chat"):(this.currentGroup.name=this.$f.getGroupShowName(e),this.currentGroup.address=e.address,this.currentGroup.chain=e.chain,this.currentGroup.type=e.type,this.createVisable=!0)},async createGroup(){let e=await m.group.create(this.currentGroup.address,this.currentGroup.chain,this.currentGroup.type);console.log(e),e.status==1&&this.$router.push("/group/"+e.data.groupId+"/chat")}},mounted(){this.$refs.searchBar.focus()}},N={class:"myChats-container"},D={class:"search-content"},H={action:"/"},x={class:"chats-container"},A={class:"chat-item"},Y={class:"content"},j={class:"left"},I={class:"title"},J={class:"desc"},z={class:"info"},E={key:0,class:"time"},F={class:"dialog-body"},K={class:"tip"},M={class:"cell-list"},O={class:"cell"},U={class:"lable"},P={class:"value"},q={class:"cell"},Q={class:"lable"},R={class:"value"},W={class:"cell"},X={class:"lable"},Z={class:"value"};function ee(e,o,se,ae,n,l){const g=r("van-nav-bar"),y=r("van-search"),C=r("Avatar"),u=r("sapn"),G=r("van-icon"),b=r("van-cell"),$=r("van-list"),T=r("DialogBase");return c(),_(v,null,[s("section",N,[s("div",null,[d(g,{fixed:"","safe-area-inset-top":"","z-index":"2",title:"Chats"})]),s("div",D,[s("form",H,[d(y,{modelValue:n.searchText,"onUpdate:modelValue":o[0]||(o[0]=a=>n.searchText=a),shape:"round","show-action":"",placeholder:e.$t("enterSearchKeyword"),ref:"searchBar",onCancel:l.onCancel,onSearch:l.onSearch,"action-text":e.$t("cancel")},null,8,["modelValue","placeholder","onCancel","onSearch","action-text"])]),s("div",x,[d($,{loading:n.searchLoading,"loading-text":e.$t("loading")},{default:i(()=>[(c(!0),_(v,null,L(n.groupList,a=>(c(),h(b,{onClick:te=>l.clickGroup(a),class:"chat-item-cell"},{default:i(()=>[s("div",A,[d(C,{class:"avatar",image:a.image?a.image:e.$f.formatIcon({chain:a.chain,address:a.address}),address:a.address},null,8,["image","address"]),s("div",Y,[s("div",null,[s("div",j,[s("div",I,t(e.$f.getGroupShowName(a)),1),a.isJoined?(c(),h(u,{key:0,class:"tag"},{default:i(()=>[p(t(e.$t("joined")),1)]),_:1})):a.isCreated&&!a.isJoined?(c(),h(u,{key:1,class:"tag tag-no-join"},{default:i(()=>[p(t(e.$t("unJoined")),1)]),_:1})):(c(),h(u,{key:2,class:"tag tag-no-create"},{default:i(()=>[p(t(e.$t("unCreated")),1)]),_:1})),a.hasProvider?(c(),h(G,{key:3,class:"cert",size:"0.4rem",name:"/assets/images/certification.png"})):f("",!0)]),s("div",J,t(`${a.memberCount} ${e.$t("members")}`),1)]),s("div",z,[a.lastChatTime?(c(),_("div",E,t(l.formatTimestamp(a.lastChatTime)),1)):f("",!0)])])])]),_:2},1032,["onClick"]))),256))]),_:1},8,["loading","loading-text"])])])]),d(T,{class:"create-dialog",visible:n.createVisable,"onUpdate:visible":o[1]||(o[1]=a=>n.createVisable=a),title:e.$t("tips"),showCancelButton:"",onOnConfirm:l.createGroup},{default:i(()=>[s("div",F,[s("div",K,t(e.$t("createGroupTips")),1),s("div",M,[s("div",O,[s("div",U,t(e.$t("groupName")+":"),1),s("div",P,t(n.currentGroup.name),1)]),s("div",q,[s("div",Q,t(e.$t("tokenAddress")+":"),1),s("div",R,t(e.$f.getGroupShowName({address:n.currentGroup.address})),1)]),s("div",W,[s("div",X,t(e.$t("chainName")+":"),1),s("div",Z,t(n.currentGroup.chain),1)])])])]),_:1},8,["visible","title","onOnConfirm"])],64)}const ce=B(S,[["render",ee],["__scopeId","data-v-57053ea7"]]);export{ce as default};
